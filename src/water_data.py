import qcelemental as qcel
import numpy as np
from . import locald4


def water_geom():
    coords = np.array(
        [
            [8, 0.0370878820, 0.0000000000, -0.0551122700],
            [1, -0.7006692913, 0.5931409324, 0.1638729949],
            [1, 0.1120576564, -0.5931409324, 0.7107987731],
            [8, -0.0116916226, -0.0550639593, 2.2876732163],
            [1, 0.7884890539, 0.1683899814, 2.7914941964],
            [1, -0.6029345083, 0.7055150610, 2.4141950038],
        ]
    )
    num = coords[:, 0]
    ang_to_bohr = qcel.constants.conversion_factor("angstrom", "bohr")
    coords = coords[:, 1:]  # * ang_to_bohr
    return num, coords

def water_geom2():
    coords = np.array(
        [
            [8.0, 0.01665435, 0.0, -0.0643079],
            [1.0, -0.07455903, -0.76693494, 0.52522351],
            [1.0, -0.18975762, 0.76693494, 0.49538957],
            [8.0, -0.04347863, 0.00992732, 2.59125275],
            [1.0, 0.41075455, 0.681702, 3.12646051],
            [1.0, 0.27928295, -0.8392558, 2.93588204],
        ]
    )
    num = coords[:, 0]
    coords = coords[:, 1:]  # * ang_to_bohr
    return num, coords

def water_data1_collect(geom_func=water_geom2):
    pos, carts = geom_func()
    params = [1, 1.61679827, 0.44959224, 3.35743605]
    charges = [0, 1]
    d4C6s, d4C8s, pairs, d4e, d4C6s_ATM = locald4.calc_dftd4_c6_c8_pairDisp2(
        pos, carts, charges, p=params, C6s_ATM=True
    )
    np.set_printoptions(linewidth=72)
    print(f"    {pos = }", end=",\n")
    print(f"    {carts = }", end=",\n")
    print(f"    {d4C6s = }", end=",\n")
    print(f"    {d4C8s = }", end=",\n")
    print(f"    {pairs = }", end=",\n")
    print(f"    {d4e = }", end=",\n")
    print(f"    {d4C6s_ATM = }", end=",\n")
    pos_A, carts_A = pos[:3], carts[:3, :]
    d4C6s_A, d4C8s_A, pairs_A, d4e_A, d4C6s_ATM_A = locald4.calc_dftd4_c6_c8_pairDisp2(
        pos_A, carts_A, charges, p=params, C6s_ATM=True
    )
    np.set_printoptions(linewidth=72)
    print(f"    {pos_A = }", end=",\n")
    print(f"    {carts_A = }", end=",\n")
    print(f"    {d4C6s_A = }", end=",\n")
    print(f"    {d4C8s_A = }", end=",\n")
    print(f"    {pairs_A = }", end=",\n")
    print(f"    {d4e_A = }", end=",\n")
    print(f"    {d4C6s_ATM_A = }", end=",\n")
    pos_B, carts_B = pos[3:], carts[3:, :]
    d4C6s_B, d4C8s_B, pairs_B, d4e_B, d4C6s_BTM_B = locald4.calc_dftd4_c6_c8_pairDisp2(
        pos_B, carts_B, charges, p=params, C6s_ATM=True
    )
    np.set_printoptions(linewidth=72)
    print(f"    {pos_B = }", end=",\n")
    print(f"    {carts_B = }", end=",\n")
    print(f"    {d4C6s_B = }", end=",\n")
    print(f"    {d4C8s_B = }", end=",\n")
    print(f"    {pairs_B = }", end=",\n")
    print(f"    {d4e_B = }", end=",\n")
    print(f"    {d4C6s_BTM_B = }", end=",\n")

    print("return (")
    print(f"        pos", end=",\n")
    print(f"        carts", end=",\n")
    print(f"        d4C6s", end=",\n")
    print(f"        d4C8s", end=",\n")
    print(f"        pairs", end=",\n")
    print(f"        d4e", end=",\n")
    print(f"        d4C6s_ATM", end=",\n")
    print(f"        pos_A", end=",\n")
    print(f"        carts_A", end=",\n")
    print(f"        d4C6s_A", end=",\n")
    print(f"        d4C8s_A", end=",\n")
    print(f"        pairs_A", end=",\n")
    print(f"        d4e_A", end=",\n")
    print(f"        d4C6s_ATM_A", end=",\n")
    print(f"        pos_B", end=",\n")
    print(f"        carts_B", end=",\n")
    print(f"        d4C6s_B", end=",\n")
    print(f"        d4C8s_B", end=",\n")
    print(f"        pairs_B", end=",\n")
    print(f"        d4e_B", end=",\n")
    print(f"        d4C6s_BTM_B", end=",\n")
    print(")")
    return


def water_data1():
    pos = (array([8.0, 1.0, 1.0, 8.0, 1.0, 1.0]),)
    carts = (
        array(
            [
                [0.03708788, 0.0, -0.05511227],
                [-0.70066929, 0.59314093, 0.16387299],
                [0.11205766, -0.59314093, 0.71079877],
                [-0.01169162, -0.05506396, 2.28767322],
                [0.78848905, 0.16838998, 2.7914942],
                [-0.60293451, 0.70551506, 2.414195],
            ]
        ),
    )
    d4C6s = (
        array(
            [
                [
                    24.63214007,
                    4.14678868,
                    3.69488521,
                    25.63191158,
                    4.10096706,
                    4.19786525,
                ],
                [
                    4.14678868,
                    0.72422622,
                    0.64530073,
                    4.31510151,
                    0.71622359,
                    0.73314662,
                ],
                [
                    3.69488521,
                    0.64530073,
                    0.57497646,
                    3.84485585,
                    0.63817022,
                    0.65324899,
                ],
                [
                    25.63191158,
                    4.31510151,
                    3.84485585,
                    26.6722619,
                    4.26742005,
                    4.36825121,
                ],
                [
                    4.10096706,
                    0.71622359,
                    0.63817022,
                    4.26742005,
                    0.70830939,
                    0.72504542,
                ],
                [
                    4.19786525,
                    0.73314662,
                    0.65324899,
                    4.36825121,
                    0.72504542,
                    0.74217689,
                ],
            ]
        ),
    )
    d4C8s = (
        array(
            [
                [
                    497.09000354,
                    64.76820479,
                    57.70997753,
                    517.2659371,
                    64.0525223,
                    65.56596367,
                ],
                [
                    64.76820479,
                    8.75470008,
                    7.80062107,
                    67.39706308,
                    8.65796148,
                    8.86253292,
                ],
                [
                    57.70997753,
                    7.80062107,
                    6.95051669,
                    60.05235144,
                    7.71442495,
                    7.89670239,
                ],
                [
                    517.2659371,
                    67.39706308,
                    60.05235144,
                    538.26077325,
                    66.65233196,
                    68.22720198,
                ],
                [
                    64.0525223,
                    8.65796148,
                    7.71442495,
                    66.65233196,
                    8.56229183,
                    8.76460278,
                ],
                [
                    65.56596367,
                    8.86253292,
                    7.89670239,
                    68.22720198,
                    8.76460278,
                    8.97169396,
                ],
            ]
        ),
    )
    pairs = (
        array(
            [
                [
                    0.00000000e00,
                    -2.21361063e-04,
                    -1.97237858e-04,
                    -8.97649709e-04,
                    -7.91316784e-05,
                    -1.22403554e-04,
                ],
                [
                    -2.21361063e-04,
                    0.00000000e00,
                    -3.98844958e-05,
                    -1.72214493e-04,
                    -1.15245491e-05,
                    -3.39932194e-05,
                ],
                [
                    -1.97237858e-04,
                    -3.98844958e-05,
                    0.00000000e00,
                    -1.98090998e-04,
                    -2.80584795e-05,
                    -3.02162633e-05,
                ],
                [
                    -8.97649709e-04,
                    -1.72214493e-04,
                    -1.98090998e-04,
                    0.00000000e00,
                    -2.27800525e-04,
                    -2.33183026e-04,
                ],
                [
                    -7.91316784e-05,
                    -1.15245491e-05,
                    -2.80584795e-05,
                    -2.27800525e-04,
                    0.00000000e00,
                    -4.48133245e-05,
                ],
                [
                    -1.22403554e-04,
                    -3.39932194e-05,
                    -3.02162633e-05,
                    -2.33183026e-04,
                    -4.48133245e-05,
                    0.00000000e00,
                ],
            ]
        ),
    )
    d4e = (-0.00507512647388,)
    d4C6s_ATM = (
        array(
            [
                [
                    14.40435705,
                    6.57407249,
                    6.57384221,
                    14.40427401,
                    6.57407249,
                    6.57407249,
                ],
                [
                    6.57407249,
                    3.11263558,
                    3.11251841,
                    6.57403769,
                    3.11263558,
                    3.11263558,
                ],
                [
                    6.57384221,
                    3.11251841,
                    3.11240124,
                    6.57380742,
                    3.11251841,
                    3.11251841,
                ],
                [
                    14.40427401,
                    6.57403769,
                    6.57380742,
                    14.40419097,
                    6.57403769,
                    6.57403769,
                ],
                [
                    6.57407249,
                    3.11263558,
                    3.11251841,
                    6.57403769,
                    3.11263558,
                    3.11263558,
                ],
                [
                    6.57407249,
                    3.11263558,
                    3.11251841,
                    6.57403769,
                    3.11263558,
                    3.11263558,
                ],
            ]
        ),
    )
    pos_A = (array([8.0, 1.0, 1.0]),)
    carts_A = (
        array(
            [
                [0.03708788, 0.0, -0.05511227],
                [-0.70066929, 0.59314093, 0.16387299],
                [0.11205766, -0.59314093, 0.71079877],
            ]
        ),
    )
    d4C6s_A = (
        array(
            [
                [24.64294071, 4.20534922, 4.20534922],
                [4.20534922, 0.74449914, 0.74449914],
                [4.20534922, 0.74449914, 0.74449914],
            ]
        ),
    )
    d4C8s_A = (
        array(
            [
                [497.30796641, 65.68285487, 65.68285487],
                [65.68285487, 8.99976619, 8.99976619],
                [65.68285487, 8.99976619, 8.99976619],
            ]
        ),
    )
    pairs_A = (
        array(
            [
                [0.00000000e00, -2.24487102e-04, -2.24487102e-04],
                [-2.24487102e-04, 0.00000000e00, -4.60157126e-05],
                [-2.24487102e-04, -4.60157126e-05, 0.00000000e00],
            ]
        ),
    )
    d4e_A = (-0.00098997983294,)
    d4C6s_ATM_A = (
        array(
            [
                [14.40436484, 6.57407412, 6.57407412],
                [6.57407412, 3.11263558, 3.11263558],
                [6.57407412, 3.11263558, 3.11263558],
            ]
        ),
    )
    pos_B = (array([8.0, 1.0, 1.0]),)
    carts_B = (
        array(
            [
                [-0.01169162, -0.05506396, 2.28767322],
                [0.78848905, 0.16838998, 2.7914942],
                [-0.60293451, 0.70551506, 2.414195],
            ]
        ),
    )
    d4C6s_B = (
        array(
            [
                [24.64294071, 4.20534922, 4.20534922],
                [4.20534922, 0.74449914, 0.74449914],
                [4.20534922, 0.74449914, 0.74449914],
            ]
        ),
    )
    d4C8s_B = (
        array(
            [
                [497.30796642, 65.68285487, 65.68285487],
                [65.68285487, 8.99976619, 8.99976619],
                [65.68285487, 8.99976619, 8.99976619],
            ]
        ),
    )
    pairs_B = (
        array(
            [
                [0.00000000e00, -2.24487102e-04, -2.24487102e-04],
                [-2.24487102e-04, 0.00000000e00, -4.60157126e-05],
                [-2.24487102e-04, -4.60157126e-05, 0.00000000e00],
            ]
        ),
    )
    d4e_B = (-0.00098997983293,)
    d4C6s_BTM_B = (
        array(
            [
                [14.40436484, 6.57407412, 6.57407412],
                [6.57407412, 3.11263558, 3.11263558],
                [6.57407412, 3.11263558, 3.11263558],
            ]
        ),
    )
    return (
        pos,
        carts,
        d4C6s,
        d4C8s,
        pairs,
        d4e,
        d4C6s_ATM,
        pos_A,
        carts_A,
        d4C6s_A,
        d4C8s_A,
        pairs_A,
        d4e_A,
        d4C6s_ATM_A,
        pos_B,
        carts_B,
        d4C6s_B,
        d4C8s_B,
        pairs_B,
        d4e_B,
        d4C6s_BTM_B,
    )



def water_data2():
    pos = array([8., 1., 1., 8., 1., 1.]),
    carts = array([[ 0.01665435,  0.        , -0.0643079 ],
       [-0.07455903, -0.76693494,  0.52522351],
       [-0.18975762,  0.76693494,  0.49538957],
       [-0.04347863,  0.00992732,  2.59125275],
       [ 0.41075455,  0.681702  ,  3.12646051],
       [ 0.27928295, -0.8392558 ,  2.93588204]]),
    d4C6s = array([[24.5287384 ,  4.00130574,  3.965384  , 25.26101853,
         4.16982869,  4.20342035],
       [ 4.00130574,  0.67714375,  0.67106468,  4.12076099,
         0.705663  ,  0.71134774],
       [ 3.965384  ,  0.67106468,  0.6650402 ,  4.08376683,
         0.69932791,  0.70496161],
       [25.26101853,  4.12076099,  4.08376683, 26.01516013,
         4.29431503,  4.32890954],
       [ 4.16982869,  0.705663  ,  0.69932791,  4.29431503,
         0.7353834 ,  0.74130757],
       [ 4.20342035,  0.71134774,  0.70496161,  4.32890954,
         0.74130757,  0.74727945]]),
    d4C8s = array([[495.00330162,  62.49592386,  61.93486632, 509.78111351,
         65.12806398,  65.65272816],
       [ 62.49592386,   8.18555059,   8.11206476,  64.36168128,
          8.53030134,   8.59902046],
       [ 61.93486632,   8.11206476,   8.03923865,  63.78387389,
          8.4537205 ,   8.5218227 ],
       [509.78111351,  64.36168128,  63.78387389, 525.00010169,
         67.07240148,  67.61272902],
       [ 65.12806398,   8.53030134,   8.4537205 ,  67.07240148,
          8.88957194,   8.96118531],
       [ 65.65272816,   8.59902046,   8.5218227 ,  67.61272902,
          8.96118531,   9.03337558]]),
    pairs = array([[ 0.00000000e+00, -2.13594992e-04, -2.11677441e-04,
        -6.88431825e-04, -4.70684537e-05, -6.15198148e-05],
       [-2.13594992e-04,  0.00000000e+00, -4.14769042e-05,
        -1.77908748e-04, -1.19982976e-05, -2.77010128e-05],
       [-2.11677441e-04, -4.14769042e-05,  0.00000000e+00,
        -1.73573772e-04, -1.94916116e-05, -1.31755653e-05],
       [-6.88431825e-04, -1.77908748e-04, -1.73573772e-04,
         0.00000000e+00, -2.29236215e-04, -2.31082915e-04],
       [-4.70684537e-05, -1.19982976e-05, -1.94916116e-05,
        -2.29236215e-04,  0.00000000e+00, -4.58184489e-05],
       [-6.15198148e-05, -2.77010128e-05, -1.31755653e-05,
        -2.31082915e-04, -4.58184489e-05,  0.00000000e+00]]),
    d4e = -0.0043875120336,
    d4C6s_ATM = array([[14.40436485,  6.57407412,  6.57407412, 14.40436484,
         6.57407412,  6.57407412],
       [ 6.57407412,  3.11263558,  3.11263558,  6.57407412,
         3.11263558,  3.11263558],
       [ 6.57407412,  3.11263558,  3.11263558,  6.57407412,
         3.11263558,  3.11263558],
       [14.40436484,  6.57407412,  6.57407412, 14.40436484,
         6.57407412,  6.57407412],
       [ 6.57407412,  3.11263558,  3.11263558,  6.57407412,
         3.11263558,  3.11263558],
       [ 6.57407412,  3.11263558,  3.11263558,  6.57407412,
         3.11263558,  3.11263558]]),
    pos_A = array([8., 1., 1.]),
    carts_A = array([[ 0.01665435,  0.        , -0.0643079 ],
       [-0.07455903, -0.76693494,  0.52522351],
       [-0.18975762,  0.76693494,  0.49538957]]),
    d4C6s_A = array([[24.64294067,  4.20534922,  4.20534922],
       [ 4.20534922,  0.74449915,  0.74449914],
       [ 4.20534922,  0.74449914,  0.74449914]]),
    d4C8s_A = array([[497.30796561,  65.682855  ,  65.68285489],
       [ 65.682855  ,   8.99976624,   8.99976622],
       [ 65.68285489,   8.99976622,   8.99976621]]),
    pairs_A = array([[ 0.00000000e+00, -2.24487102e-04, -2.24487102e-04],
       [-2.24487102e-04,  0.00000000e+00, -4.60157127e-05],
       [-2.24487102e-04, -4.60157127e-05,  0.00000000e+00]]),
    d4e_A = -0.00098997983411,
    d4C6s_ATM_A = array([[14.40436485,  6.57407412,  6.57407412],
       [ 6.57407412,  3.11263558,  3.11263558],
       [ 6.57407412,  3.11263558,  3.11263558]]),
    pos_B = array([8., 1., 1.]),
    carts_B = array([[-0.04347863,  0.00992732,  2.59125275],
       [ 0.41075455,  0.681702  ,  3.12646051],
       [ 0.27928295, -0.8392558 ,  2.93588204]]),
    d4C6s_B = array([[24.64294081,  4.2053492 ,  4.20534921],
       [ 4.2053492 ,  0.74449913,  0.74449913],
       [ 4.20534921,  0.74449913,  0.74449914]]),
    d4C8s_B = array([[497.30796829,  65.68285463,  65.6828548 ],
       [ 65.68285463,   8.99976609,   8.99976611],
       [ 65.6828548 ,   8.99976611,   8.99976614]]),
    pairs_B = array([[ 0.00000000e+00, -2.24487101e-04, -2.24487102e-04],
       [-2.24487101e-04,  0.00000000e+00, -4.60157122e-05],
       [-2.24487102e-04, -4.60157122e-05,  0.00000000e+00]]),
    d4e_B = -0.00098997983003,
    d4C6s_BTM_B = array([[14.40436484,  6.57407412,  6.57407412],
       [ 6.57407412,  3.11263558,  3.11263558],
       [ 6.57407412,  3.11263558,  3.11263558]]),
    return (
            pos,
            carts,
            d4C6s,
            d4C8s,
            pairs,
            d4e,
            d4C6s_ATM,
            pos_A,
            carts_A,
            d4C6s_A,
            d4C8s_A,
            pairs_A,
            d4e_A,
            d4C6s_ATM_A,
            pos_B,
            carts_B,
            d4C6s_B,
            d4C8s_B,
            pairs_B,
            d4e_B,
            d4C6s_BTM_B,
        )

